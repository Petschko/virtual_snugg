
<!-- It all goes in one file! Take it all you dirty html slut! -->

<canvas id="sexyGoesHere" width="400" height="300"></canvas>
<br>
wsad and space move the snugg
<br>
c clears and r raises the amount of tinies

<img id="snugg1" src="snugg1.png" hidden="true"></img>
<img id="snugg2" src="snugg2.png" hidden="true"></img>
<img id="snugg3" src="snugg3.png" hidden="true"></img>
<img id="snugg_buttcrush" src="snugg_buttcrush.png" hidden="true"></img>
<img id="snugg_buttcrush_forward" src="snugg_buttcrush_forward.png" hidden="true"></img>
<img id="snugg_buttcrush_backward" src="snugg_buttcrush_backward.png" hidden="true"></img>
<img id="snugg_bellycrush1" src="snugg_bellycrush1.png" hidden="true"></img>
<img id="snugg_bellycrush2" src="snugg_bellycrush2.png" hidden="true"></img>
<img id="bg" src="bg.png" hidden="true"></img>
<img id="stick" src="stick.png" hidden="true"></img>
<img id="house" src="house.png" hidden="true"></img>
<img id="exhouse" src="exhouse.png" hidden="true"></img>

<script>
// basic stuff
var canvas = document.getElementById("sexyGoesHere");
var ctx = canvas.getContext("2d");
ctx.fillStyle = "#FF0000";//bloooooooood!
var frame = 0;
var snuggframes = [snugg1,snugg2,snugg3];
var snuggX = 10;
var snuggY = 10;
var goingRight=false;
var goingLeft=false;
var jumping = false;
var buttcrushing = false;
var yVol = 0;
var touchingGround = false;
var correct = true;
var snuggfloor = 280;
var bellycrushing = false;
var sliding = false;
var stand_up = false;


function keyDown(e) {
    if (e.code == "Space" && !jumping && touchingGround && !buttcrushing && !bellycrushing){
        jumping=true;
        touchingGround=false;
        snuggY-=10;
        yVol = -20;
    }else if (e.code == "Space"){//JUMP
        //no more jumping
    }else if (e.code == "KeyD"){//RIGHT
        if(!buttcrushing && !bellycrushing){
            correct=true;
        }
        goingRight=true;
    }else if (e.code == "KeyA"){//LEFT
        if(!buttcrushing && !bellycrushing){
            correct=false;
        }
        goingLeft=true
    }else if (e.code == "KeyS"){//DOWN
        if ((goingRight || goingLeft)
            && !bellycrushing){
            bellycrushing = true;
            sliding=true;
            frame = 0;
        }else{
            if (!buttcrushing && touchingGround) crushTinies();
            buttcrushing=true;
        }
    }else if (e.code == "KeyR"){
        makeMoreTinies();
    }else if (e.code == "KeyC"){
        initTinies();
    }

}
function keyUp(e) {
    if (e.code == "Space"){
        jumping=false;
        yVol = 0;
    }else if (e.code == "KeyD"){
        goingRight=false;
        sliding=false;
    }else if (e.code == "KeyA"){
        goingLeft=false;
        sliding=false;
    }else if (e.code == "KeyS"){
        buttcrushing=false;
        stand_up=true;
    }

}

document.addEventListener('keydown', keyDown);
document.addEventListener('keyup', keyUp);

function drawSnugg(){
    var img;
    snuggoffset = 0
    if(bellycrushing){
        snuggoffset= 20;//correct?25:20;
        if(frame<3) img = snugg_bellycrush1;
        else img = snugg_bellycrush2;
        if (frame==3){
            crushTiniesWithBellyAndBoobs();
        }
    }else if(buttcrushing){
        if (correct){
            if (goingRight) img = snugg_buttcrush_forward;
            else if (goingLeft) img = snugg_buttcrush_backward;
            else img = snugg_buttcrush;
        }else{
            if (goingLeft) img = snugg_buttcrush_forward;
            else if (goingRight) img = snugg_buttcrush_backward;
            else img = snugg_buttcrush;
        }
    }else if (goingLeft || goingRight) img = snuggframes[frame%3];
    else img = snugg1;
    if(correct){
        ctx.translate(canvas.width, 0);
        ctx.scale(-1, 1);
        ctx.drawImage(img,canvas.width-snugg1.width-snuggoffset-snuggX,snuggY);
        ctx.translate(canvas.width, 0);
        ctx.scale(-1, 1);
    }else{
        ctx.drawImage(img,snuggX-snuggoffset,snuggY);
    }
}

function initTinies(){
    tinies = [];
    crushed = [];
    houses = [];
    exhouses = [];
}
initTinies();
function makeMoreTinies(){
    for (var i = 0; i<10;i++) tinies.push(Math.random()*400);
    for (var i = 0; i<3;i++) houses.push(Math.random()*400);
}
makeMoreTinies();


function drawSticks(){
    for (var i = 0; i<tinies.length;i++){
        if(tinies[i]>snuggX+25) tinies[i]+=Math.random()*1;
        else tinies[i]-=Math.random()*1;
        ctx.drawImage(stick,tinies[i],snuggfloor-stick.height);
    }
    //ctx.globalAlpha = 1.0;
    for (var i = 0; i<crushed.length;i++){
        ctx.fillRect(crushed[i], snuggfloor-1, 5, 1);
    }
}
function drawEvenHouses(){
    for (var i = 0; i<houses.length;i+=2){
        ctx.drawImage(house,houses[i],snuggfloor-house.height+1);
    }
    //ctx.globalAlpha = 0.5;
    for (var i = 0; i<exhouses.length;i+=2){
        ctx.drawImage(exhouse,exhouses[i],snuggfloor-exhouse.height+1);
    }
}
function drawOddHouses(){
    for (var i = 1; i<houses.length;i+=2){
        ctx.drawImage(house,houses[i],snuggfloor-house.height+1);
    }
    //ctx.globalAlpha = 0.5;
    for (var i = 1; i<exhouses.length;i+=2){
        ctx.drawImage(exhouse,exhouses[i],snuggfloor-exhouse.height+1);
    }
}
function crushTinies(){
    for (var i = 0; i<tinies.length;i++){
        if (tinies[i] > snuggX && tinies[i] < snuggX+snugg1.width){
            crushed.push(tinies[i]);
            delete tinies[i];
        }
    }
    for (var i = 0; i<houses.length;i++){
        if (houses[i]+house.width > snuggX && houses[i] < snuggX+snugg1.width){
            exhouses.push(houses[i]);
            delete houses[i];
        }
    }
}
function crushTiniesWithBellyAndBoobs(){
    if(touchingGround){
        offset = correct ? -15:0;
        for (var i = 0; i<tinies.length;i++){
            if (tinies[i] > snuggX+offset && tinies[i] < snuggX+offset+60){
                crushed.push(tinies[i]);
                delete tinies[i];
            }
        }
        for (var i = 0; i<houses.length;i++){
            if (houses[i]+house.width > snuggX+offset && houses[i] < snuggX+offset+60){
                exhouses.push(houses[i]);
                delete houses[i];
            }
        }
    }
}


function tik() {
    frame++;
    ctx.clearRect(0,0,400,300);
    ctx.drawImage(bg,0,0);
    drawEvenHouses();
    drawSnugg();
    drawOddHouses();
    drawSticks();

    if (stand_up && frame >5){
        bellycrushing=false;
        stand_up = false;
    }
    if ((!touchingGround || !buttcrushing)// u cant move when butcrushing and on ground
        ){
        if (!bellycrushing){
            if(goingLeft) snuggX-=10;
            if(goingRight) snuggX+=10;
        }else{
            if (frame < 13 && sliding){
                if(goingLeft) snuggX-=14-frame;
                if(goingRight) snuggX+=14-frame;
                crushTiniesWithBellyAndBoobs();
            }
        }
    }

    if(jumping) {
        yVol-=4;
    }
    if (snuggY < snuggfloor-snugg1.height){
        yVol+=6;
        if (buttcrushing) yVol+=4;
        snuggY+=yVol;
    }
    if (snuggY >= snuggfloor-snugg1.height){
        if(!touchingGround) crushTinies();
        touchingGround=true;
        snuggY = snuggfloor-snugg1.height;
    }
    setTimeout(tik,100);
}

tik();

</script>
